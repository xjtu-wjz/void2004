import{at as ke,au as j,av as he,D as Ie,E as re,G as xe,H as ie,d as ve,aw as oe,ax as we,ay as ye,I as Ce,J as Te,az as Ee,L as A,aA as Ne,aB as Oe,i as L,N as le,S as ze,O as Le,b as V,e as ce,w as I,j as f,al as Re,g as x,P as g,f as n,Z as ue,as as Se,x as D,ac as O,ar as Ae,c as J,F as fe,aC as Me,aD as $e,aE as Xe,aF as Be,ab as Fe,aG as Ve,aH as De,k as We,aI as Ye,aJ as Pe,r as He,aK as je,R as Ge,W as H,aL as M,X as Ke}from"./app-B5BMfZs9.js";var Ze=/\s/;function Je(e){for(var r=e.length;r--&&Ze.test(e.charAt(r)););return r}var Ue=/^\s+/;function qe(e){return e&&e.slice(0,Je(e)+1).replace(Ue,"")}var de=NaN,Qe=/^[-+]0x[0-9a-f]+$/i,ea=/^0b[01]+$/i,aa=/^0o[0-7]+$/i,na=parseInt;function me(e){if(typeof e=="number")return e;if(ke(e))return de;if(j(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=j(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=qe(e);var l=ea.test(e);return l||aa.test(e)?na(e.slice(2),l?2:8):Qe.test(e)?de:+e}var U=function(){return he.Date.now()},ta="Expected a function",sa=Math.max,ra=Math.min;function ia(e,r,l){var d,s,p,T,t,w,y=0,$=!1,E=!1,b=!0;if(typeof e!="function")throw new TypeError(ta);r=me(r)||0,j(l)&&($=!!l.leading,E="maxWait"in l,p=E?sa(me(l.maxWait)||0,r):p,b="trailing"in l?!!l.trailing:b);function m(i){var _=d,C=s;return d=s=void 0,y=i,T=e.apply(C,_),T}function R(i){return y=i,t=setTimeout(S,r),$?m(i):T}function c(i){var _=i-w,C=i-y,P=r-_;return E?ra(P,p-C):P}function W(i){var _=i-w,C=i-y;return w===void 0||_>=r||_<0||E&&C>=p}function S(){var i=U();if(W(i))return X(i);t=setTimeout(S,c(i))}function X(i){return t=void 0,b&&d?m(i):(d=s=void 0,T)}function Y(){t!==void 0&&clearTimeout(t),y=0,d=w=s=t=void 0}function G(){return t===void 0?T:X(U())}function B(){var i=U(),_=W(i);if(d=arguments,s=this,w=i,_){if(t===void 0)return R(w);if(E)return clearTimeout(t),t=setTimeout(S,r),m(w)}return t===void 0&&(t=setTimeout(S,r)),T}return B.cancel=Y,B.flush=G,B}var oa="Expected a function";function q(e,r,l){var d=!0,s=!0;if(typeof e!="function")throw new TypeError(oa);return j(l)&&(d="leading"in l?!!l.leading:d,s="trailing"in l?!!l.trailing:s),ia(e,r,{leading:d,maxWait:r,trailing:s})}const la=e=>Object.keys(e),ca=Ie({urlList:{type:re(Array),default:()=>xe([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:re(String)}}),ua={close:()=>!0,switch:e=>ie(e),rotate:e=>ie(e)},fa=ve({name:"ElImageViewer"}),da=ve({...fa,props:ca,emits:ua,setup(e,{expose:r,emit:l}){var d;const s=e,p={CONTAIN:{name:"contain",icon:oe(we)},ORIGINAL:{name:"original",icon:oe(ye)}},{t:T}=Ce(),t=Te("image-viewer"),{nextZIndex:w}=Ee(),y=A(),$=A([]),E=Ne(),b=A(!0),m=A(s.initialIndex),R=Oe(p.CONTAIN),c=A({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),W=A((d=s.zIndex)!=null?d:w()),S=L(()=>{const{urlList:a}=s;return a.length<=1}),X=L(()=>m.value===0),Y=L(()=>m.value===s.urlList.length-1),G=L(()=>s.urlList[m.value]),B=L(()=>[t.e("btn"),t.e("prev"),t.is("disabled",!s.infinite&&X.value)]),i=L(()=>[t.e("btn"),t.e("next"),t.is("disabled",!s.infinite&&Y.value)]),_=L(()=>{const{scale:a,deg:u,offsetX:o,offsetY:v,enableTransition:k}=c.value;let h=o/a,N=v/a;const F=u*Math.PI/180,te=Math.cos(F),se=Math.sin(F);h=h*te+N*se,N=N*te-o/a*se;const Z={transform:`scale(${a}) rotate(${u}deg) translate(${h}px, ${N}px)`,transition:k?"transform .3s":""};return R.value.name===p.CONTAIN.name&&(Z.maxWidth=Z.maxHeight="100%"),Z});function C(){ge(),l("close")}function P(){const a=q(o=>{switch(o.code){case M.esc:s.closeOnPressEscape&&C();break;case M.space:ee();break;case M.left:ae();break;case M.up:z("zoomIn");break;case M.right:ne();break;case M.down:z("zoomOut");break}}),u=q(o=>{const v=o.deltaY||o.deltaX;z(v<0?"zoomIn":"zoomOut",{zoomRate:s.zoomRate,enableTransition:!1})});E.run(()=>{H(document,"keydown",a),H(document,"wheel",u)})}function ge(){E.stop()}function pe(){b.value=!1}function be(a){b.value=!1,a.target.alt=T("el.image.error")}function _e(a){if(b.value||a.button!==0||!y.value)return;c.value.enableTransition=!1;const{offsetX:u,offsetY:o}=c.value,v=a.pageX,k=a.pageY,h=q(F=>{c.value={...c.value,offsetX:u+F.pageX-v,offsetY:o+F.pageY-k}}),N=H(document,"mousemove",h);H(document,"mouseup",()=>{N()}),a.preventDefault()}function Q(){c.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ee(){if(b.value)return;const a=la(p),u=Object.values(p),o=R.value.name,k=(u.findIndex(h=>h.name===o)+1)%a.length;R.value=p[a[k]],Q()}function K(a){const u=s.urlList.length;m.value=(a+u)%u}function ae(){X.value&&!s.infinite||K(m.value-1)}function ne(){Y.value&&!s.infinite||K(m.value+1)}function z(a,u={}){if(b.value)return;const{minScale:o,maxScale:v}=s,{zoomRate:k,rotateDeg:h,enableTransition:N}={zoomRate:s.zoomRate,rotateDeg:90,enableTransition:!0,...u};switch(a){case"zoomOut":c.value.scale>o&&(c.value.scale=Number.parseFloat((c.value.scale/k).toFixed(3)));break;case"zoomIn":c.value.scale<v&&(c.value.scale=Number.parseFloat((c.value.scale*k).toFixed(3)));break;case"clockwise":c.value.deg+=h,l("rotate",c.value.deg);break;case"anticlockwise":c.value.deg-=h,l("rotate",c.value.deg);break}c.value.enableTransition=N}return le(G,()=>{ze(()=>{const a=$.value[0];a!=null&&a.complete||(b.value=!0)})}),le(m,a=>{Q(),l("switch",a)}),Le(()=>{var a,u;P(),(u=(a=y.value)==null?void 0:a.focus)==null||u.call(a)}),r({setActiveItem:K}),(a,u)=>(V(),ce(n(je),{to:"body",disabled:!a.teleported},{default:I(()=>[f(Re,{name:"viewer-fade",appear:""},{default:I(()=>[x("div",{ref_key:"wrapper",ref:y,tabindex:-1,class:g(n(t).e("wrapper")),style:ue({zIndex:W.value})},[x("div",{class:g(n(t).e("mask")),onClick:Se(o=>a.hideOnClickModal&&C(),["self"])},null,10,["onClick"]),D(" CLOSE "),x("span",{class:g([n(t).e("btn"),n(t).e("close")]),onClick:C},[f(n(O),null,{default:I(()=>[f(n(Ae))]),_:1})],2),D(" ARROW "),n(S)?D("v-if",!0):(V(),J(fe,{key:0},[x("span",{class:g(n(B)),onClick:ae},[f(n(O),null,{default:I(()=>[f(n(Me))]),_:1})],2),x("span",{class:g(n(i)),onClick:ne},[f(n(O),null,{default:I(()=>[f(n($e))]),_:1})],2)],64)),D(" ACTIONS "),x("div",{class:g([n(t).e("btn"),n(t).e("actions")])},[x("div",{class:g(n(t).e("actions__inner"))},[f(n(O),{onClick:o=>z("zoomOut")},{default:I(()=>[f(n(Xe))]),_:1},8,["onClick"]),f(n(O),{onClick:o=>z("zoomIn")},{default:I(()=>[f(n(Be))]),_:1},8,["onClick"]),x("i",{class:g(n(t).e("actions__divider"))},null,2),f(n(O),{onClick:ee},{default:I(()=>[(V(),ce(Fe(n(R).icon)))]),_:1}),x("i",{class:g(n(t).e("actions__divider"))},null,2),f(n(O),{onClick:o=>z("anticlockwise")},{default:I(()=>[f(n(Ve))]),_:1},8,["onClick"]),f(n(O),{onClick:o=>z("clockwise")},{default:I(()=>[f(n(De))]),_:1},8,["onClick"])],2)],2),D(" CANVAS "),x("div",{class:g(n(t).e("canvas"))},[(V(!0),J(fe,null,We(a.urlList,(o,v)=>Ye((V(),J("img",{ref_for:!0,ref:k=>$.value[v]=k,key:o,src:o,style:ue(n(_)),class:g(n(t).e("img")),crossorigin:a.crossorigin,onLoad:pe,onError:be,onMousedown:_e},null,46,["src","crossorigin"])),[[Pe,v===m.value]])),128))],2),He(a.$slots,"default")],6)]),_:3})]),_:3},8,["disabled"]))}});var ma=Ge(da,[["__file","image-viewer.vue"]]);const ga=Ke(ma);export{ga as E,ca as i};
